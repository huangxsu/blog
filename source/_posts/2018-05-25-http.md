---
title: HTTP协议
date: 2018-05-25 14:57:01
tags:
- HTTP
- HTTPS
---

重要的 HTTP 协议，很重要。《图解 HTTP》读书笔记。

<!--more-->

# 了解 Web 和网络基础

## 使用 HTTP 协议访问 Web

Web 使用 HTTP（HyperText Transfer Protocol）协议作为规范，完成从客户端到服务端等一系列运作流程，建立通信。

## 网络基础 TCP/IP

1、 TCP/IP 协议族

计算机与网络设备要相互通信，双方就得基于相同的方法。

协议中存在格式各样的内容。从电缆的规格到 IP 地址的选定方法、寻找异地用户的方法、双方建立通信的顺序，以及 Web 页面显示需要处理的步骤。

这些互联网相关协议的集合总称为 TCP/IP。

2、 TCP/IP 分层管理

TCP/IP 协议族按层次分为 4 层： 应用层、传输层、网络层、数据链路层。

分层的好处是当有改动时不用牵一发而动全身，只需把变动的层替换掉即可；分层后每个层的内部设置也更自由、简单。

TCP/IP 协议族各层的作用：

1.  `应用层` 决定了提供服务时的通信活动。TCP/IP 协议族预存了各类通用的应用服务。比如：FTP 和 DNS。HTTP 协议也在这层。
2.  `传输层` 为应用层提供位于网络连接两端的数据传输。有两个性质不同的协议：TCP（Transmission Control Protocol，传输控制协议）和 UDP（User Data Protocol，用户数据包协议）。
3.  `网络层` 用来处理网络上流动的数据包。数据包是网络传输的最小数据单位。该层规定了通过怎样的路径（传输路线）到达对方计算机，并把数据包传送给对方。网络层的作用就是选择一条传输路线，使得通信顺利进行。
4.  `链路层` 用了处理连接网络的硬件部分。硬件上的范畴均在链路层的作用范围之内。

3、 TCP/IP 通信传输流

{% asset_img TCPIP-1.png 500 TCP/IP %}

利用 TCP/IP 协议族进行网络通信是，发送端从应用层往下走，接收端往应用层上走。

以 HTTP 为例，发送端在应用层（HTTP 协议）发出一个想看某个 Web 页面的 HTTP 请求。

接着，为了传输方便，在传输层（TCP 协议）把从应用层收到的数据（HTTP 请求报文）进行分割。并在各个报文上打上标记序号及端口号后转发给网络层。

在网络层（IP 协议），增加通信目的地的 MAC 地址，转发给链路层。

接收端在链路层接收到数据，按序往上层发送，直到应用层，才算真正接收到客户端发送过来的 HTTP 请求。

{% asset_img TCPIP-2.png 500 封装 %}

在发送端，每经过一层就会被打上该层所属的首部信息，反之，接收端每经过一层会把对应的首部消去。这种把数据信息包装起来的做法称为封装（encapsulate）。

## 与 HTTP 关系密切的协议 IP、TCP 和 DNS

1、 负责域名解析的 DNS 服务

`DNS`服务和 HTTP 协议一样位于应用层，它提供域名到 IP 地址之间的解析服务，或逆向从 IP 地址反查域名的服务。

2、 确保可靠性的 TCP 协议

`TCP`位于传输层，提供可靠的字节流服务。

字节流服务是指将大块数据分割成以报文段为单位的数据包进行管理。

TCP 协议采用三次握手（three-way handshaking）策略确保数据无误。握手过程使用 TCP 的标志——SYN(synchronize)和 ACK(acknowledgement)。

发送端发送一个带 SYN 标志的数据包给对方，接收端收到后，回传一个带有 SYN/ACK 标志的数据包以示确认信息，最后，发送端再回传一个带 ACK 标志的数据，代表“握手”结束。

{% asset_img TCP-three.png TCP 三次握手 %}

3、 负责传输的 IP 协议

`IP`（Internet Protocol）网际协议位于网络层。TCP/IP 协议族中的 IP 指的就网际协议。IP 和 IP 地址是两个术语，IP 是一种协议的名称。

IP 协议的作用是把各种数据包传送给对方。两个重要的条件是 IP 地址和 MAC 地址（Media Access Control Address）。IP 地址指明了节点被分配到的地址，MAC 地址是指网关所属的固定地址。IP 地址可以和 MAC 地址进行配对。IP 地址可变换，MAC 地址基本不变。

IP 间的通信依赖 MAC 地址，在网络上，通常是经过多台计算机和网络设备中转才能连接到对方。中转中会利用下一站中转设备的 MAC 地址来搜索中转目标。这时，会采用 ARP 协议（Address Resolution Protocol），一种解析地址的协议，通过通信方的 IP 地址反查出对应的 MAC 地址。这种机制称为路由选择。

4、 各种协议与 HTTP 协议的关系

{% asset_img TCP-all.png 各种协议与 HTTP 协议的关系 %}

## URI 和 URL

URI（Uniform Resource Identifier），由某个协议方案表示的资源的定位标识符。URL 表示资源的地点（互联网上所处的位置），URL 是 URI 的子集。

{% asset_img URI.png 绝对 URI 格式 %}
